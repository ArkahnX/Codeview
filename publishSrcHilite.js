/**
 * cannot confirm this will work with unmodified template
 */
JSDOC.PluginManager.registerPlugin("JSDOC.publishSrcHilite", {
	onPublishSrc: function(src) {
		if (src.path in JsHilite.cache) {
			return; // already generated src code
		} else JsHilite.cache[src.path] = true;

		try {
			var sourceCode = IO.readFile(src.path);
		} catch (e) {
			print(e.message);
			quit();
		}
		var header = '<!DOCTYPE html>' + "\n" + '<html>' + "\n" + '<head>' + "\n" + '<meta charset="utf-8"></meta>' + "\n" + '<meta name="generator" content="JsDoc Toolkit"></meta>' + "\n" + '<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"></meta>' + "\n" + '<meta name="mobileoptimized" content="0"></meta>' + "\n" + '<style>' + "\n" + base64_decode(css) + "\n" + "</style>" + "\n" + "<script>" + "\n" + base64_decode(js) + "\n" + "</script>" + "\n" + "</head>" + "\n" + "<body>" + "\n" + "<pre>" + "\n" + "<code class=\"js\">" + "\n";
		var footer = "</code>" + "\n" + "</pre>" + "\n" + "<script>" + "\n" + "highlightJavascript.format();" + "\n" + "</script>" + "\n" + "</body>" + "\n" + "</html>";
		src.hilited = header + sourceCode + footer;
	}
});

function JsHilite(src) {
	this.src = src;
	this.header = '<!DOCTYPE html>' + "\n" + '<html>' + "\n" + '<head>' + "\n" + '<meta charset="utf-8"></meta>' + "\n" + '<meta name="generator" content="JsDoc Toolkit"></meta>' + "\n" + '<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"></meta>' + "\n" + '<meta name="mobileoptimized" content="0"></meta>' + "\n" + '<style>' + "\n" + base64_decode(css) + "\n" + "</style>" + "\n" + "<script>" + "\n" + base64_decode(js) + "\n" + "highlightJavascript.format();" + "\n" + "</script>" + "\n" + "</head>" + "\n" + "<body>" + "\n" + "<pre>" + "\n" + "<code class=\"js\">" + "\n";
	this.footer = "</code>" + "\n" + "</pre>" + "\n" + "<script>" + "\n" + base64_decode(js) + "\n" + "highlightJavascript.format();" + "\n" + "</script>" + "\n" + "</body>" + "\n" + "</html>";
}

JsHilite.cache = {};

JsHilite.prototype.hilite = function() {
	return this.header + this.src + this.footer;
}

function utf8_decode(str_data) {
	// Converts a UTF-8 encoded string to ISO-8859-1
	//
	// version: 1109.2015
	// discuss at: http://phpjs.org/functions/utf8_decode
	// +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
	// +      input by: Aman Gupta
	// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// +   improved by: Norman "zEh" Fuchs
	// +   bugfixed by: hitwork
	// +   bugfixed by: Onno Marsman
	// +      input by: Brett Zamir (http://brett-zamir.me)
	// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// *     example 1: utf8_decode('Kevin van Zonneveld');
	// *     returns 1: 'Kevin van Zonneveld'
	var tmp_arr = [],
		i = 0,
		ac = 0,
		c1 = 0,
		c2 = 0,
		c3 = 0;

	str_data += '';

	while (i < str_data.length) {
		c1 = str_data.charCodeAt(i);
		if (c1 < 128) {
			tmp_arr[ac++] = String.fromCharCode(c1);
			i++;
		} else if (c1 > 191 && c1 < 224) {
			c2 = str_data.charCodeAt(i + 1);
			tmp_arr[ac++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));
			i += 2;
		} else {
			c2 = str_data.charCodeAt(i + 1);
			c3 = str_data.charCodeAt(i + 2);
			tmp_arr[ac++] = String.fromCharCode(((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
			i += 3;
		}
	}

	return tmp_arr.join('');
};

function base64_decode(data) {
	// Decodes string using MIME base64 algorithm
	//
	// version: 1109.2015
	// discuss at: http://phpjs.org/functions/base64_decode
	// +   original by: Tyler Akins (http://rumkin.com)
	// +   improved by: Thunder.m
	// +      input by: Aman Gupta
	// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// +   bugfixed by: Onno Marsman
	// +   bugfixed by: Pellentesque Malesuada
	// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// +      input by: Brett Zamir (http://brett-zamir.me)
	// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// -    depends on: utf8_decode
	// *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
	// *     returns 1: 'Kevin van Zonneveld'
	// mozilla has this native
	// - but breaks in 2.0.0.12!
	//if (typeof this.window['btoa'] == 'function') {
	//    return btoa(data);
	//}
	var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
	var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
		ac = 0,
		dec = "",
		tmp_arr = [];

	if (!data) {
		return data;
	}

	data += '';

	do { // unpack four hexets into three octets using index points in b64
		h1 = b64.indexOf(data.charAt(i++));
		h2 = b64.indexOf(data.charAt(i++));
		h3 = b64.indexOf(data.charAt(i++));
		h4 = b64.indexOf(data.charAt(i++));

		bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

		o1 = bits >> 16 & 0xff;
		o2 = bits >> 8 & 0xff;
		o3 = bits & 0xff;

		if (h3 == 64) {
			tmp_arr[ac++] = String.fromCharCode(o1);
		} else if (h4 == 64) {
			tmp_arr[ac++] = String.fromCharCode(o1, o2);
		} else {
			tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
		}
	} while (i < data.length);

	dec = tmp_arr.join('');
	dec = utf8_decode(dec);

	return dec;
};
var css = "QGNoYXJzZXQgInV0Zi04IjsNCnByZSB7DQoJYmFja2dyb3VuZC1jb2xvcjpyZ2JhKDIzOCwyMzgsMjM4LDAuOTIxNSk7DQoJbWFyZ2luOjA7DQoJLypvdmVyZmxvdzphdXRvOw0KCXdoaXRlLXNwYWNlOiBwcmUtd3JhcDsNCgl3aGl0ZS1zcGFjZTogLXByZS13cmFwOw0KCXdoaXRlLXNwYWNlOiAtby1wcmUtd3JhcDsNCgl3aGl0ZS1zcGFjZTogLW1vei1wcmUtd3JhcDsNCgl3aGl0ZS1zcGFjZTogLWhwLXByZS13cmFwOw0KCXdvcmQtd3JhcDogYnJlYWstd29yZDsqLw0KfQ0KDQpvbCB7DQoJbGlzdC1zdHlsZS10eXBlOmRlY2ltYWwtbGVhZGluZy16ZXJvOw0KCW1hcmdpbjowOw0KCW1hcmdpbi1sZWZ0OjNlbTsNCgltYXJnaW4tdG9wOjAhaW1wb3J0YW50Ow0KCW1hcmdpbi1ib3R0b206MCFpbXBvcnRhbnQ7DQoJcGFkZGluZzowOw0KCWRpc3BsYXk6aW5saW5lLWJsb2NrOw0KCWJhY2tncm91bmQtY29sb3I6cmdiYSgyMzgsMjM4LDIzOCwwLjkyMTUpOw0KfQ0KcHJlIGNvZGUgbGkgew0KCWZvbnQtZmFtaWx5OiBDb25zb2xhcywgIkNvdXJpZXIgTmV3IjsNCgljb2xvcjpyZ2JhKDEyNSwgMTI1LCAxMjUsIDAuOTU2ODYpOw0KCWJhY2tncm91bmQtY29sb3I6cmdiYSgyMzgsMjM4LDIzOCwwLjkyMTUpOw0KfQ0KcHJlIGNvZGUgbGkgc3BhbiB7DQoJZm9udC1mYW1pbHk6Q29uc29sYXMsICJDb3VyaWVyIE5ldyI7DQoJY29sb3I6YmxhY2s7DQp9DQpwcmUgY29kZSBsaS5oaWdobGlnaHRlZCB7DQoJYmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLDAuMTAxOTYpOw0KfQ0KcHJlIGNvZGUgLmNvbW1lbnQgew0KCWNvbG9yOiMwMDY2RkY7DQoJZm9udC1zdHlsZTogaXRhbGljOw0KfQ0KcHJlIGNvZGUgLnN0cmluZyB7DQoJY29sb3I6IzAwOTkzMzsNCn0NCnByZSBjb2RlIC5udW1iZXIgew0KCWNvbG9yOiMwMDY2RkY7DQp9DQpwcmUgY29kZSAubmF0aXZlIHsNCgljb2xvcjojMDAwMEZGOw0KCWZvbnQtd2VpZ2h0OmJvbGQ7DQp9DQpwcmUgY29kZSAuY29uc3RydWN0cyB7DQoJY29sb3I6IzAwMDBGRjsNCn0NCnByZSBjb2RlIC5sYW5ndWFnZSB7DQoJY29sb3I6Izk3MDBDQzsNCn0NCnByZSBjb2RlIC5yZXNlcnZlZCB7DQoJY29sb3I6IzAwMDAwMDsNCglmb250LXdlaWdodDogYm9sZDsNCn0NCnByZSBjb2RlIC5jb25zdGFudCB7DQoJY29sb3I6IzY3ODJEMzsNCn0NCnByZSBjb2RlIC5mdW5jdGlvbiB7DQoJY29sb3I6I0ZGODAwMDsNCn0NCnByZSBjb2RlIC5yZWdleCB7DQoJY29sb3I6I0ZGMDA4MDsNCn0NCg0KOjotd2Via2l0LXNjcm9sbGJhciB7DQoJaGVpZ2h0OjExcHg7DQoJd2lkdGg6MTFweDsNCn0NCjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWIgew0KCS13ZWJraXQtYm94LXNoYWRvdzppbnNldCAxcHggMXB4IDAgcmdiYSgwLDAsMCwuMSksaW5zZXQgMCAtMXB4IDAgcmdiYSgwLDAsMCwuMDcpOw0KCWJhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMik7DQoJbWluLWhlaWdodDoyOHB4Ow0KCXBhZGRpbmctdG9wOjEwMHB4Ow0KfQ0KDQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsNCgktd2Via2l0LWJveC1zaGFkb3c6aW5zZXQgMXB4IDFweCAxcHggcmdiYSgwLDAsMCwuMjUpOw0KCWJhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuNCk7DQp9DQoNCjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6YWN0aXZlIHsNCgktd2Via2l0LWJveC1zaGFkb3c6aW5zZXQgMXB4IDFweCAzcHggcmdiYSgwLDAsMCwuMzUpOw0KCWJhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuNSk7DQp9DQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrIHsNCgliYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC4wNSk7DQp9DQoNCjo6LXdlYmtpdC1zY3JvbGxiYXItdHJhY2s6dmVydGljYWwgew0KCWJvcmRlci10b3A6MXB4IHNvbGlkICNkZGQ7DQoJYm9yZGVyLWJvdHRvbToxcHggc29saWQgI2RkZDsNCn0NCg0KOjotd2Via2l0LXNjcm9sbGJhci10cmFjazpob3Jpem9udGFsIHsNCglib3JkZXItbGVmdDoxcHggc29saWQgI2RkZDsNCglib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNkZGQ7DQp9DQoNCjo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6dmVydGljYWwgew0KCWJvcmRlci13aWR0aDowOw0KCWJvcmRlci1sZWZ0LXdpZHRoOjBweDsNCglib3JkZXItcmlnaHQtd2lkdGg6MHB4Ow0KfQ0KDQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvcml6b250YWwgew0KCWJvcmRlci13aWR0aDowOw0KCWJvcmRlci1ib3R0b206MHB4Ow0KCWJvcmRlci10b3A6MHB4Ow0KfQ0KDQo6Oi13ZWJraXQtc2Nyb2xsYmFyLXRyYWNrOmhvdmVyIHsNCgktd2Via2l0LWJveC1zaGFkb3c6aW5zZXQgMXB4IDAgMCByZ2JhKDAsMCwwLC4xKTsNCgliYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjA1KTsNCn0NCg0KOjotd2Via2l0LXNjcm9sbGJhci10cmFjazphY3RpdmUgew0KCS13ZWJraXQtYm94LXNoYWRvdzppbnNldCAxcHggMCAwIHJnYmEoMCwwLDAsLjE0KSxpbnNldCAtMXB4IDAgMCByZ2JhKDAsMCwwLC4xNCk7DQoJYmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4xKTsNCn0=";
var js = "LyoqDQogKiBoaWdobGlnaHRKYXZhc2NyaXB0LmpzIFYwLjkNCiAqIE5ldyBpbiBWMC45IC0gZmlyc3Qgc3RhYmxlIHJlbGVhc2UhIE9wdG9taXphdGlvbnMgYW5kIGNvbW1lbnRzIHRvIGJlIGFkZGVkIGZvciAxLjANCiAqLw0KKGZ1bmN0aW9uKHdpbmRvdykgew0KCSJ1c2Ugc3RyaWN0IjsNCgl2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7DQoJdmFyIGhpZ2hsaWdodEphdmFzY3JpcHQgPSBmdW5jdGlvbihpbnB1dCwgb3B0aW9ucywgbGFuZ3VhZ2UpIHsNCgkJCXZhciBsaW5lcywgbWFyZ2luTGVmdCwgdHlwZSwgbmFtZSwgaWQsIGF0dHI7DQoJCQl2YXIgZWxlbWVudCA9IGlucHV0Ow0KCQkJdmFyIHNlbGVjdG9yID0gaW5wdXQuaWQ7DQoJCQl2YXIgb3JpZ2luYWxDb2RlID0gaW5wdXQuaW5uZXJIVE1MOw0KCQkJdmFyIHN0YXJ0ID0gIjxvbD4iOw0KCQkJdmFyIGVuZCA9ICI8L29sPiI7DQoJCQl2YXIgY29kZSA9IGlucHV0LmlubmVySFRNTDsNCgkJCXZhciBpbnRlcm5hbFJlZ2V4ID0gew0KCQkJCS8qKg0KCQkJCSAqIHJlZ2V4IHdpdGhvdXQgd2hpdGVzcGFjZQ0KCQkJCSAqIG1hdGNoZXMgLw0KCQkJCSAqIGlzIG5vdCBmb2xsb3dlZCBieSBhICoNCgkJCQkgKiBtdXN0IGNvbnRhaW4gb25lIG9yIG1vcmUgb2YgcHJldHR5IG11Y2ggYW55dGhpbmcNCgkJCQkgKiBoYXMgYSAvDQoJCQkJICogb3B0aW9uYWwgZmxhZ3MNCgkJCQkgKiBpcyBub3QgZm9sbG93ZWQgYnkgc3BhY2VzLCBsZXR0ZXJzIG9yIG51bWJlcnMuDQoJCQkJICogY2FzZSBpbnNlbnNpdGl2ZS4NCgkJCQkgKi8NCgkJCQlyZWdleDE6IC9cLyg/IVtcKl0pKD86W1xgXH5cIVxAXCNcJFwlXF5cJlwqXChcKVwtXF9cPVwrXFtce1xdXH1cXFx8XDtcOlwnXCJcLFw8XC5cPlwvXD9hLXowLTldKStcL1tnaW1dKig/PVwsfFw7fFxdfFwpfFx9fFxufFxyfFxuXHJ8JCkoPyFbYS16MC05XDA0MF0pL2dpLA0KCQkJCS8qKg0KCQkJCSAqIHJlZ2V4IHdpdGggd2hpdGVzcGFjZQ0KCQkJCSAqIG1hdGNoZXMgLw0KCQkJCSAqIGlzIG5vdCBmb2xsb3dlZCBieSBhICoNCgkJCQkgKiBtdXN0IGNvbnRhaW4gb25lIG9yIG1vcmUgb2YgcHJldHR5IG11Y2ggYW55dGhpbmcNCgkJCQkgKiBoYXMgYSAvDQoJCQkJICogb3B0aW9uYWwgZmxhZ3MNCgkJCQkgKiBpcyBub3QgZm9sbG93ZWQgYnkgc3BhY2VzLCBsZXR0ZXJzIG9yIG51bWJlcnMuDQoJCQkJICogY2FzZSBpbnNlbnNpdGl2ZS4NCgkJCQkgKi8NCgkJCQlyZWdleDI6IC9cLyg/IVtcKl0pKD86XDA0MCpbXGBcflwhXEBcI1wkXCVcXlwmXCpcKFwpXC1cX1w9XCtcW1x7XF1cfVxcXHxcO1w6XCdcIlwsXDxcLlw+XC9cP2EtejAtOV0pK1wvW2dpbV0qKD89XCx8XDt8XF18XCl8XH18XG58XHJ8XG5ccikoPyFbYS16MC05XDA0MF0pL2dpLA0KCQkJCS8qKg0KCQkJCSAqIG51bWJlcnMNCgkJCQkgKi8NCgkJCQludW1iZXI6IC9cYlsrLV0/KD86KD86MHhbQS1GYS1mMC05XSspfCg/Oig/OltcZF0qXC4pP1tcZF0rKD86W2VFXVsrLV0/W1xkXSspPykpdT8oPzooPzppbnQoPzo4fDE2fDMyfDY0KSl8TCk/XGIoPyFcfVx+KS9nLA0KCQkJCS8qKg0KCQkJCSAqIG1hdGNoZXMgYW5kIGZvcmdldHMgJw0KCQkJCSAqIG1hdGNoZXMgYW5kIGZvcmdldHMgJyBvciBcDQoJCQkJICogbWF0Y2hlcyBhbmQgZm9yZ2V0cyBcIGFuZCBhbGwgY2hhcmFjdGVycw0KCQkJCSAqIG1hdGNoZXMgYW5kIGZvcmdldHMgJw0KCQkJCSAqIG9yDQoJCQkJICogbWF0Y2hlcyBhbmQgZm9yZ2V0cyAiDQoJCQkJICogbWF0Y2hlcyBhbmQgZm9yZ2V0cyAiIG9yIFwNCgkJCQkgKiBtYXRjaGVzIGFuZCBmb3JnZXRzIFwgYW5kIGFsbCBjaGFyYWN0ZXJzDQoJCQkJICogbWF0Y2hlcyBhbmQgZm9yZ2V0cyAiDQoJCQkJICovDQoJCQkJc3RyaW5nOiAvKD86J1teJ1xcXSooPzpcXC5bXidcXF0qKSonKXwoPzoiW14iXFxdKig/OlxcLlteIlxcXSopKiIpL2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyBhbmQgcmVtZW1iZXJzICgxKSB3aGl0ZXNwYWNlDQoJCQkJICogbWF0Y2hlcyBhbmQgcmVtZW1iZXJzICgxKSBvbmUgY2hhcmFjdGVyIG9mIGEgbGV0dGVyLCBudW1iZXIgb3Igd2hpdGVzcGFjZQ0KCQkJCSAqIG1hdGNoZXMgYW5kIHJlbWVtYmVycyAoMikgLy8NCgkJCQkgKiBtYXRjaGVzIGFuZCByZW1lbWJlcnMgKDIpIGFsbCBjaGFyYWN0ZXJzIHVudGlsIG5ldyBsaW5lDQoJCQkJICogY2FzZSBpbnNlbnNpdGl2ZQ0KCQkJCSAqLw0KCQkJCXNpbmdsZUNvbW1lbnQ6IC9cL1wvLis/KD89XG58XHJ8JCkvaWcsDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyAvICoNCgkJCQkgKiBtYXRjaGVzIGFueSB3aGl0ZXNwYWNlIGFuZCBub24gd2hpdGVzcGFjZQ0KCQkJCSAqIG1hdGNoZXMgKiAvDQoJCQkJICovDQoJCQkJbXVsdGlDb21tZW50OiAvXC9cKltcc1xTXSs/XCpcLy9nLA0KCQkJCS8qKg0KCQkJCSAqIG1hdGNoZXMgd2hpdGVzcGFjZSBiZWZvcmUgb3IgYWZ0ZXIgc3RyaW5nDQoJCQkJICovDQoJCQkJd2hpdGVTcGFjZTogL15ccyt8XHMrJC9nLA0KCQkJCS8qKg0KCQkJCSAqIG1hdGNoZXMgYW55IGNhcmFnZSByZXR1cm4NCgkJCQkgKi8NCgkJCQluZXdsaW5lOiAvW1xyXG5dL2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyAiDQoJCQkJICovDQoJCQkJcXVvdGU6IC8iL2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyA8DQoJCQkJICovDQoJCQkJbGVzc3RoYW46IC88L2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyA+DQoJCQkJICovDQoJCQkJZ3JlYXRlcnRoYW46IC8+L2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyAmDQoJCQkJICovDQoJCQkJYW1wZXJzYW5kOiAvJi9nLA0KCQkJCS8qKg0KCQkJCSAqIG1hdGNoZXMgfnsNCgkJCQkgKiBtYXRjaGVzIGFuZCByZW1lbWJlcnMgKDEpIHNwZWNpZmljIHdvcmRzDQoJCQkJICogZm9sbG93ZWQgYnkgLQ0KCQkJCSAqIG1hdGNoZXMgYW5kIHJlbWVtYmVycyAoMikgMC05IG9uZSBvciBtb3JlIHRpbWVzDQoJCQkJICogZm9sbG93ZWQgYnkgfX4NCgkJCQkgKiBjYXNlIGluc2Vuc2l0aXZlDQoJCQkJICovDQoJCQkJdGVtcG9yYXJ5OiAvfnsoc3RyaW5nfGxpbmt8Y29kZXxzaW5nbGVDb21tZW50fG11bHRpQ29tbWVudHxsZXNzdGhhbnxncmVhdGVydGhhbnxhbXBlcnNhbmR8cXVvdGV8ZXNjYXBlZClcLShbMC05XSspfX4vaWcsDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyA8YQ0KCQkJCSAqIHdpdGggaHJlZj0iLi4uIg0KCQkJCSAqIGFuZCBvdGhlciBhdHRyaWJ1dGVzDQoJCQkJICogbWF0Y2hlcyA+DQoJCQkJICogbWF0Y2hlcyB0ZXh0DQoJCQkJICogbWF0Y2hlcyA8L2E+DQoJCQkJICovDQoJCQkJbGluazogL1w8YVxiIGhyZWZcPVwiW2h0cGZzXStcOlwvXC9bXiJdK1wiW14+XSpcPig/Oi4qPylcPFwvYVw+L2csDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyA8DQoJCQkJICogbWF0Y2hlcyBhbmQgZm9yZ2V0cyAhIG9yIC8NCgkJCQkgKiBtYXRjaGVzIGFscGhhLW51bWVyaWMgdGFnIG5hbWUNCgkJCQkgKiBtYXRjaGVzIGFuZCBmb3JnZXRzIGF0dHJpYnV0ZXMNCgkJCQkgKiBtYXRjaGVzID4NCgkJCQkgKi8NCgkJCQl0YWc6IC9cPCg/OlwhfFwvKT9bYS16XVthLXowLTFcLV1ccyooPzpbXj5dKyk/XD4vaWcsDQoJCQkJLyoqDQoJCQkJICogbWF0Y2hlcyB1cmwNCgkJCQkgKi8NCgkJCQl1cmw6IC8oPzpodHRwfGZ0cHxodHRwcyk6XC9cL1tcd1wtX10rKD86XC5bXHdcLV9dKykrKD86W1x3XC1cLixAP149JSZhbXA7OlwvflwrI10qW1x3XC1cQD9ePSUmYW1wO1wvflwrI10pPy9nDQoJCQl9Ow0KCQkJdmFyIGRhdGEgPSB7DQoJCQkJc2luZ2xlQ29tbWVudDoge30sDQoJCQkJbXVsdGlDb21tZW50OiB7fSwNCgkJCQlzdHJpbmc6IHt9LA0KCQkJCWNvZGU6IHt9LA0KCQkJCWxpbms6IHt9LA0KCQkJCWxlc3N0aGFuOiB7IjAiOiImbHQ7In0sDQoJCQkJZ3JlYXRlcnRoYW46IHsiMCI6IiZndDsifSwNCgkJCQlhbXBlcnNhbmQ6IHsiMCI6IiZhbXA7In0sDQoJCQkJcXVvdGU6IHsiMCI6IiZxdW90OyJ9LA0KCQkJCWVzY2FwZWQ6IHt9DQoJCQl9Ow0KCQkJdmFyIHJlZ2V4ID0ge307DQoJCQkvKioNCgkJCSAqIE1ha2UgYSByZWZlcmVuY2UgdG8gdGhlIGxhbmd1YWdlIHZhbHVlcy4gSmF2YXNjcmlwdCBsYW5ndWFnZSBkZWZpbml0aW9uIGlzIGluY2x1ZGVkIGJ5IGRlZmF1bHQuDQoJCQkgKi8NCgkJCWZvciAodmFyIGF0dHIgaW4gaW50ZXJuYWxSZWdleCkgew0KCQkJCWlmIChpbnRlcm5hbFJlZ2V4Lmhhc093blByb3BlcnR5KGF0dHIpKSB7DQoJCQkJCWlmIChsYW5ndWFnZS5yZWdleFthdHRyXSkgew0KCQkJCQkJcmVnZXhbYXR0cl0gPSBsYW5ndWFnZS5yZWdleFthdHRyXTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXJlZ2V4W2F0dHJdID0gaW50ZXJuYWxSZWdleFthdHRyXTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCWZvciAodmFyIGF0dHIgaW4gbGFuZ3VhZ2UucmVnZXgpIHsNCgkJCQlpZiAobGFuZ3VhZ2UucmVnZXguaGFzT3duUHJvcGVydHkoYXR0cikpIHsNCgkJCQkJaWYgKCFyZWdleFthdHRyXSkgew0KCQkJCQkJcmVnZXhbYXR0cl0gPSBsYW5ndWFnZS5yZWdleFthdHRyXTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCS8vIHZhciByZWdleCA9IGxhbmd1YWdlLnJlZ2V4Ow0KCQkJdmFyIHJlZ2V4TGlzdCA9IGxhbmd1YWdlLnJlZ2V4TGlzdDsNCgkJCXZhciB0eXBlcyA9IFsic2luZ2xlQ29tbWVudCIsICJtdWx0aUNvbW1lbnQiLCAic3RyaW5nIl07DQoJCQl2YXIgaSA9IDA7DQoJCQl2YXIgZSA9IDA7DQoJCQkvKioNCgkJCSAqIHJlbW92ZSBiZWdpbm5pbmcgYW5kIHRyYWlsaW5nIHdoaXRlc3BhY2UgZm9yIHRoZSBzY3JpcHQgdG8gd29yayBwcm9wZXJseS4NCgkJCSAqLw0KCQkJY29kZSA9IGNvZGUucmVwbGFjZShpbnRlcm5hbFJlZ2V4LndoaXRlU3BhY2UsICIiKTsNCgkJCS8qKg0KCQkJICogRnVuY3Rpb25zIGRlZmluZWQgb3V0c2lkZSBvZiBhbGwgbG9vcHMgaW4gb3JkZXIgdG8gcHJldmVudCBoYXZpbmcgdG8gcmVjcmVhdGUgdGhlbSByZXBlYXRlZGx5Lg0KCQkJICovDQoJCQl2YXIgb2Zmc2V0RnVuY3Rpb25zID0gW107DQoJCQlvZmZzZXRGdW5jdGlvbnNbMF0gPSBmdW5jdGlvbihzdHJpbmcsIG9mZnNldCkgew0KCQkJCWRhdGEubGlua1tvZmZzZXRdID0gc3RyaW5nOw0KCQkJCXJldHVybiAifntsaW5rLSIgKyBvZmZzZXQgKyAifX4iOw0KCQkJfTsNCgkJCW9mZnNldEZ1bmN0aW9uc1sxXSA9IGZ1bmN0aW9uKHN0cmluZykgew0KCQkJCXZhciB6ZXJvID0gMDsNCgkJCQl2YXIgb3JpZ2luYWxTdHJpbmcgPSBzdHJpbmc7DQoJCQkJaWYoc3RyaW5nLm1hdGNoKGludGVybmFsUmVnZXgucXVvdGUpKSB7DQoJCQkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKGludGVybmFsUmVnZXgucXVvdGUsIGZ1bmN0aW9uKHN0cmluZywgb2Zmc2V0KSB7DQoJCQkJCQlyZXR1cm4gIn57cXVvdGUtIit6ZXJvKyJ9fiI7DQoJCQkJCX0pOw0KCQkJCX0NCgkJCQlpZihzdHJpbmcubWF0Y2goaW50ZXJuYWxSZWdleC5hbXBlcnNhbmQpKSB7DQoJCQkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKGludGVybmFsUmVnZXguYW1wZXJzYW5kLCBmdW5jdGlvbihzdHJpbmcsIG9mZnNldCkgew0KCQkJCQkJcmV0dXJuICJ+e2FtcGVyc2FuZC0iK3plcm8rIn1+IjsNCgkJCQkJfSk7DQoJCQkJfQ0KCQkJCWlmKHN0cmluZy5tYXRjaChpbnRlcm5hbFJlZ2V4Lmxlc3N0aGFuKSkgew0KCQkJCQlzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShpbnRlcm5hbFJlZ2V4Lmxlc3N0aGFuLCBmdW5jdGlvbihzdHJpbmcsIG9mZnNldCkgew0KCQkJCQkJcmV0dXJuICJ+e2xlc3N0aGFuLSIremVybysifX4iOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQkJaWYoc3RyaW5nLm1hdGNoKGludGVybmFsUmVnZXguZ3JlYXRlcnRoYW4pKSB7DQoJCQkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKGludGVybmFsUmVnZXguZ3JlYXRlcnRoYW4sIGZ1bmN0aW9uKHN0cmluZywgb2Zmc2V0KSB7DQoJCQkJCQlyZXR1cm4gIn57Z3JlYXRlcnRoYW4tIit6ZXJvKyJ9fiI7DQoJCQkJCX0pOw0KCQkJCX0NCgkJCQlyZXR1cm4gc3RyaW5nDQoJCQl9Ow0KCQkJb2Zmc2V0RnVuY3Rpb25zWzJdID0gZnVuY3Rpb24oc3RyaW5nLCBvZmZzZXQpIHsNCgkJCQlkYXRhLmxpbmtbb2Zmc2V0XSA9ICI8YSBocmVmPVwiIiArIHN0cmluZyArICJcIj4iICsgc3RyaW5nICsgIjwvYT4iOw0KCQkJCXJldHVybiAifntsaW5rLSIgKyBvZmZzZXQgKyAifX4iOw0KCQkJfTsNCgkJCW9mZnNldEZ1bmN0aW9uc1szXSA9IGZ1bmN0aW9uKHN0cmluZywgb2Zmc2V0LCBjb2RlKSB7DQoJCQkJaWYoY29kZS5jaGFyQXQob2Zmc2V0LTEpID09PSAiXFwiIHx8IGNvZGUuY2hhckF0KG9mZnNldC0xKSA9PT0gIjwiKSB7DQoJCQkJCXJldHVybiBzdHJpbmc7DQoJCQkJfQ0KCQkJCXZhciBtYXRjaCA9IGZhbHNlOw0KCQkJCWlmICh0eXBlID09PSAic3RyaW5nIiAmJiByZWdleC5lc2NhcGVkICYmIHN0cmluZy5tYXRjaChyZWdleC5lc2NhcGVkKSkgew0KCQkJCQltYXRjaCA9IHRydWU7DQoJCQkJCS8vcGFyc2UgZXNjYXBlZCBjaGFyYWN0ZXJzDQoJCQkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4LmVzY2FwZWQsIG9mZnNldEZ1bmN0aW9uc1s4XSk7DQoJCQkJfQ0KCQkJCS8qKg0KCQkJCSAqIFBhcnNlIGh0bWwgZW5hYmxpbmcgY29kZSBvdXQgb2YgZXF1YXRpb24NCgkJCQkgKi8NCgkJCQlzdHJpbmcgPSBvZmZzZXRGdW5jdGlvbnNbMV0oc3RyaW5nKTsNCgkJCQlkYXRhW3R5cGVdW29mZnNldF0gPSBzdHJpbmc7DQoJCQkJcmV0dXJuICJ+eyIgKyB0eXBlICsgIi0iICsgb2Zmc2V0ICsgIn1+IjsNCgkJCX07DQoJCQlvZmZzZXRGdW5jdGlvbnNbNF0gPSBmdW5jdGlvbihzdHJpbmcpIHsNCg0KCQkJCXJldHVybiAiPC9zcGFuPiIgKyBzdHJpbmcgKyAiPHNwYW4gY2xhc3M9XCIiICsgc3R5bGUgKyAiXCI+IjsNCgkJCX07DQoJCQlvZmZzZXRGdW5jdGlvbnNbNV0gPSBmdW5jdGlvbihzdHJpbmcpIHsNCgkJCQkvKioNCgkJCQkgKiBQYXJzZSBodG1sIGVuYWJsaW5nIGNvZGUgb3V0IG9mIGVxdWF0aW9uDQoJCQkJICovDQoJCQkJdmFyIG5ld1N0cmluZyA9IG9mZnNldEZ1bmN0aW9uc1sxXShzdHJpbmcpOw0KCQkJCWRhdGEuY29kZVtlXSA9ICI8c3BhbiBjbGFzcz1cIiIgKyByZWdleExpc3RbaV0uY3NzICsgIlwiPiIgKyBuZXdTdHJpbmcgKyAiPC9zcGFuPiI7DQoJCQkJZSA9IGUgKyAxOw0KCQkJCXJldHVybiAifntjb2RlLSIgKyAoZSAtIDEpICsgIn1+IjsNCgkJCX07DQoJCQlvZmZzZXRGdW5jdGlvbnNbNl0gPSBmdW5jdGlvbihzdHJpbmcsIG5hbWUsIG51bWJlcikgew0KCQkJCXJldHVybiBkYXRhW25hbWVdW251bWJlcl07DQoJCQl9Ow0KCQkJb2Zmc2V0RnVuY3Rpb25zWzddID0gZnVuY3Rpb24oc3RyaW5nLCBvZmZzZXQsIGNvZGUpIHsNCgkJCQkvL3BhcnNlIGVzY2FwZWQgY2hhcmFjdGVycw0KCQkJCWlmIChyZWdleC5lc2NhcGVkKSB7DQoJCQkJCXN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4LmVzY2FwZWQsIG9mZnNldEZ1bmN0aW9uc1s4XSk7DQoJCQkJfQ0KCQkJCS8qKg0KCQkJCSAqIFJlbW92ZSBhbnkgYnJhY2tldHMgdGhhdCBtYXkgY2F1c2UgdGhlIGJyb3dzZXIgdG8gcGFyc2UgdGhlIGNvZGUgYXMgaHRtbA0KCQkJCSAqLw0KCQkJCXZhciBuZXdTdHJpbmcgPSBvZmZzZXRGdW5jdGlvbnNbMV0oc3RyaW5nKTsNCgkJCQlkYXRhLmNvZGVbZV0gPSAiPHNwYW4gY2xhc3M9XCJyZWdleFwiPiIgKyBuZXdTdHJpbmcgKyAiPC9zcGFuPiI7DQoJCQkJZSA9IGUgKyAxOw0KCQkJCXJldHVybiAifntjb2RlLSIgKyAoZSAtIDEpICsgIn1+IjsNCgkJCX07DQoJCQlvZmZzZXRGdW5jdGlvbnNbOF0gPSBmdW5jdGlvbihzdHJpbmcpIHsNCgkJCQkvKioNCgkJCQkgKiBSZW1vdmUgYW55IGJyYWNrZXRzIHRoYXQgbWF5IGNhdXNlIHRoZSBicm93c2VyIHRvIHBhcnNlIHRoZSBjb2RlIGFzIGh0bWwNCgkJCQkgKi8NCgkJCQl2YXIgbmV3U3RyaW5nID0gb2Zmc2V0RnVuY3Rpb25zWzFdKHN0cmluZyk7DQoJCQkJZGF0YS5lc2NhcGVkW2VdID0gIjxzcGFuIGNsYXNzPVwiY29uc3RhbnRcIj4iICsgbmV3U3RyaW5nICsgIjwvc3Bhbj4iOw0KCQkJCWUgPSBlICsgMTsNCgkJCQlyZXR1cm4gIn57ZXNjYXBlZC0iICsgKGUgLSAxKSArICJ9fiI7DQoJCQl9Ow0KCQkJb2Zmc2V0RnVuY3Rpb25zWzldID0gZnVuY3Rpb24oc3RyaW5nLCBvZmZzZXQsIGNvZGUpIHsNCgkJCQlpZihjb2RlLmNoYXJBdChvZmZzZXQtMSkgPT09ICJcXCIgfHwgY29kZS5jaGFyQXQob2Zmc2V0LTEpID09PSAiPCIpIHsNCgkJCQkJcmV0dXJuIHN0cmluZzsNCgkJCQl9DQoJCQkJLy9wYXJzZSBlc2NhcGVkIGNoYXJhY3RlcnMNCgkJCQlpZiAocmVnZXguZXNjYXBlZCkgew0KCQkJCQlzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShyZWdleC5lc2NhcGVkLCBvZmZzZXRGdW5jdGlvbnNbOF0pOw0KCQkJCX0NCgkJCQkvKioNCgkJCQkgKiBSZW1vdmUgYW55IGJyYWNrZXRzIHRoYXQgbWF5IGNhdXNlIHRoZSBicm93c2VyIHRvIHBhcnNlIHRoZSBjb2RlIGFzIGh0bWwNCgkJCQkgKi8NCgkJCQl2YXIgbmV3U3RyaW5nID0gb2Zmc2V0RnVuY3Rpb25zWzFdKHN0cmluZyk7DQoJCQkJZGF0YS5jb2RlW2VdID0gIjxzcGFuIGNsYXNzPVwicmVnZXhcIj4iICsgbmV3U3RyaW5nICsgIjwvc3Bhbj4iOw0KCQkJCWUgPSBlICsgMTsNCgkJCQlyZXR1cm4gIn57Y29kZS0iICsgKGUgLSAxKSArICJ9fiI7DQoJCQl9Ow0KCQkJLyoqDQoJCQkgKiByZW1vdmUgYW55IHVubmVjZXNzYXJ5IGZvcm1hdHRpbmcNCgkJCSAqLw0KCQkJY29kZSA9IGNvZGUucmVwbGFjZSgvJmFtcDsvaWcsIiYiKTsNCgkJCWNvZGUgPSBjb2RlLnJlcGxhY2UoLyZsdDsvaWcsIjwiKTsNCgkJCWNvZGUgPSBjb2RlLnJlcGxhY2UoLyZndDsvaWcsIj4iKTsNCgkJCS8qKg0KCQkJICogc2F2ZSBsaW5rcw0KCQkJICovDQoJCQljb2RlID0gY29kZS5yZXBsYWNlKHJlZ2V4LmxpbmssIG9mZnNldEZ1bmN0aW9uc1swXSkNCgkJCS8qKg0KCQkJICogVXNlZCB0byBmaXggaXNzdWUgY2F1c2VkIGJ5IDxwcmU+PGNvZGUgY2xhc3M9IiI+Li4uPC9jb2RlPjwvcHJlPiBiZWluZyB3aXRoaW4gdGhlIGNvZGUuDQoJCQkgKiBUaGUgYnJvd3NlciB3b3VsZCByZWFkIHRoZSB0YWdzIGFuZCBpbXBsZW1lbnQgdGhlbSwgY2F1c2luZyB1bmRlc2lyZWQgZWZmZWN0cy4NCgkJCSAqIEluIHJlYWxpdHkgd2Ugd2FudCB0aGUgdGFncyB0byBzaG93IHVwIGFzIHRleHQsIG5vdCBiZSByZW5kZXJlZC4NCgkJCSAqLw0KDQoJCQkvKioNCgkJCSAqIEludGVycHJldCB1cmxzIGFzIGxpbmtzLg0KCQkJICovDQoJCQlpZiAoY29kZS5tYXRjaChyZWdleC51cmwpKSB7DQoJCQkJY29kZSA9IGNvZGUucmVwbGFjZShyZWdleC51cmwsIG9mZnNldEZ1bmN0aW9uc1syXSk7DQoJCQl9DQoJCQkvKioNCgkJCSAqIENvbW1lbnQgYW5kIFN0cmluZyBwYXJzaW5nIGFyZSBwcmFjdGljYWxseSB0aGUgc2FtZSwgd2l0aCBkaWZmZXJlbnQgcGFyYW1ldGVycyBiZWluZyB0aGUgb25seSBkaWZmZXJlbmNlLCBzbyB3ZSBvcHRvbWl6ZSBieSB1c2luZyB0aGlzIGxvb3AgdG8gYXZvaWQgY29kZSBkdXBsaWNhdGlvbi4NCgkJCSAqIENvbW1lbnQgYW5kIHN0cmluZyByZWdleCB0byBsb29rIGZvciBpcyBwcm92aWRlZCBieSB0aGUgbGFuZ3VhZ2UgZGVmaW5pdGlvbi4NCgkJCSAqLw0KCQkJZm9yIChpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKSB7DQoJCQkJdHlwZSA9IHR5cGVzW2ldOw0KCQkJCS8qKg0KCQkJCSAqIE1hdGNoIHJlZ2V4IGJlZm9yZSBjb21tZW50cyBzbyB0aGF0IHRoZXkgYXJlIG1hcHBlZCBvdXQgcHJvcGVybHkNCgkJCQkgKi8NCgkJCQlpZiAodHlwZSA9PT0gInN0cmluZyIgJiYgY29kZS5tYXRjaChyZWdleC5yZWdleDEpKSB7DQoJCQkJCWNvZGUgPSBjb2RlLnJlcGxhY2UocmVnZXgucmVnZXgxLCBvZmZzZXRGdW5jdGlvbnNbOV0pOw0KCQkJCX0NCgkJCQlpZiAodHlwZSA9PT0gInN0cmluZyIgJiYgY29kZS5tYXRjaChyZWdleC5yZWdleDIpKSB7DQoJCQkJCWNvZGUgPSBjb2RlLnJlcGxhY2UocmVnZXgucmVnZXgyLCBvZmZzZXRGdW5jdGlvbnNbN10pOw0KCQkJCX0NCgkJCQlpZiAoY29kZS5tYXRjaChyZWdleFt0eXBlXSkpIHsNCgkJCQkJY29kZSA9IGNvZGUucmVwbGFjZShyZWdleFt0eXBlXSwgb2Zmc2V0RnVuY3Rpb25zWzNdKTsNCgkJCQkJZm9yIChhdHRyIGluIGRhdGFbdHlwZV0pIHsNCgkJCQkJCS8qKg0KCQkJCQkJICogSWYgT2JqZWN0LnByb3RvdHlwZSBoYXMgYmVlbiBtb2RpZmllZCB3ZSBuZWVkIHRoZSBiZWxvdyBsaW5lLg0KCQkJCQkJICovDQoJCQkJCQlpZiAoZGF0YVt0eXBlXS5oYXNPd25Qcm9wZXJ0eShhdHRyKSkgew0KCQkJCQkJCWlmICh0eXBlLmluZGV4T2YoIkNvbW1lbnQiKSA+IC0xKSB7DQoJCQkJCQkJCXZhciBzdHlsZSA9ICJjb21tZW50IjsNCgkJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCQl2YXIgc3R5bGUgPSAic3RyaW5nIjsNCgkJCQkJCQl9DQoJCQkJCQkJZGF0YVt0eXBlXVthdHRyXSA9ICI8c3BhbiBjbGFzcz1cIiIgKyBzdHlsZSArICJcIj4iICsgZGF0YVt0eXBlXVthdHRyXTsNCgkJCQkJCQlpZiAoZGF0YVt0eXBlXVthdHRyXS5tYXRjaChyZWdleC5uZXdsaW5lKSkgew0KCQkJCQkJCQlkYXRhW3R5cGVdW2F0dHJdID0gZGF0YVt0eXBlXVthdHRyXS5yZXBsYWNlKHJlZ2V4Lm5ld2xpbmUsIG9mZnNldEZ1bmN0aW9uc1s0XSk7DQoJCQkJCQkJfQ0KCQkJCQkJCWRhdGFbdHlwZV1bYXR0cl0gPSBkYXRhW3R5cGVdW2F0dHJdICsgIjwvc3Bhbj4iOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQkJLyoqDQoJCQkgKiBSdW4gdGhyb3VnaCBlYWNoIGN1c3RvbSBkZWZpbmVkIHJlZ2V4IHVzZWQgYnkgdGhlIGxhbmd1YWdlLg0KCQkJICovDQoJCQlmb3IgKGkgPSAwOyBpIDwgcmVnZXhMaXN0Lmxlbmd0aDsgaSsrKSB7DQoJCQkJaWYgKGNvZGUubWF0Y2gocmVnZXhMaXN0W2ldLnJlZ2V4KSkgew0KCQkJCQljb2RlID0gY29kZS5yZXBsYWNlKHJlZ2V4TGlzdFtpXS5yZWdleCwgb2Zmc2V0RnVuY3Rpb25zWzVdKTsNCgkJCQl9DQoJCQl9DQoJCQkvKioNCgkJCSAqIFJlcGxhY2UgYWxsIHRlbXBvcmFyeSBjb2RlIHBsYWNlaG9sZGVycyB3aXRoIHRoZSBwYXJzZWQgdmFsdWVzLiBUaGlzIHByZXZlbnRzIGR1cGxpY2F0ZSBwYXJzaW5nLg0KCQkJICovDQoJCQl3aGlsZSAoY29kZS5tYXRjaChyZWdleC50ZW1wb3JhcnkpKSB7DQoJCQkJY29kZSA9IGNvZGUucmVwbGFjZShpbnRlcm5hbFJlZ2V4LnRlbXBvcmFyeSwgb2Zmc2V0RnVuY3Rpb25zWzZdKTsNCgkJCX0NCgkJCS8vIGlmKHJlZ2V4LmVzY2FwZWQpIHsNCgkJCS8vIAljb2RlID0gY29kZS5yZXBsYWNlKHJlZ2V4LmVzY2FwZWQsIG9mZnNldEZ1bmN0aW9uc1s4XSk7DQoJCQkvLyB9DQoJCQkvKioNCgkJCSAqIFNwbGl0IG5ld2xpbmVzIGludG8gbGlzdCBpdGVtcyBmb3IgcHJvcGVyIG51bWJlcmluZy4NCgkJCSAqLw0KCQkJaWYgKGNvZGUubWF0Y2gocmVnZXgubmV3bGluZSkpIHsNCgkJCQljb2RlID0gY29kZS5zcGxpdChyZWdleC5uZXdsaW5lKTsNCgkJCQljb2RlID0gY29kZS5qb2luKCI8L3NwYW4+PC9saT48bGk+PHNwYW4+Iik7DQoJCQl9DQoJCQljb2RlID0gIjxsaT48c3Bhbj4iICsgY29kZSArICI8L3NwYW4+PC9saT4iOw0KCQkJLyoqDQoJCQkgKiBSZXBsYWNlIHByZSB0YWcgY29kZSB3aXRoIHBhcnNlZCBjb2RlLg0KCQkJICovDQoJCQllbGVtZW50LmlubmVySFRNTCA9IChzdGFydCArIGNvZGUgKyBlbmQpOw0KCQkJLyoqDQoJCQkgKiBTdHlsZSBmb3IgbmV3bGluZXMuDQoJCQkgKi8NCgkJCWlmIChvcHRpb25zICYmICgob3B0aW9uc1tzZWxlY3Rvcl0gJiYgb3B0aW9uc1tzZWxlY3Rvcl0uaW5kZXhPZigibm9saW5lcyIpID4gLTEpIHx8IG9wdGlvbnMuYWxsLmluZGV4T2YoIm5vbGluZXMiKSA+IC0xKSkgew0KCQkJCWVsZW1lbnQuY2hpbGRyZW5bMF0uc3R5bGUubWFyZ2luTGVmdCA9ICI1cHgiOw0KCQkJCWVsZW1lbnQuY2hpbGRyZW5bMF0uc3R5bGUubGlzdFN0eWxlVHlwZSA9ICJub25lIjsNCgkJCX0gZWxzZSB7DQoJCQkJbGluZXMgPSAoKG9yaWdpbmFsQ29kZS5pbmRleE9mKCJcbiIpICE9PSAtMSkgPyBvcmlnaW5hbENvZGUuc3BsaXQoIlxuIikgOiBvcmlnaW5hbENvZGUuc3BsaXQoIlxyIikpLmxlbmd0aDsNCgkJCQlpZiAobGluZXMgPiAxMDApIHsNCgkJCQkJaWYgKGxpbmVzID4gMTAwMCkgew0KCQkJCQkJZWxlbWVudC5jaGlsZHJlblswXS5zdHlsZS5tYXJnaW5MZWZ0ID0gIjVlbSI7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQllbGVtZW50LmNoaWxkcmVuWzBdLnN0eWxlLm1hcmdpbkxlZnQgPSAiNGVtIjsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJfTsNCgloaWdobGlnaHRKYXZhc2NyaXB0LmdldEtleXdvcmRzID0gZnVuY3Rpb24oc3RyKSB7DQoJCXN0ciA9IHN0ci5qb2luKCIgIik7DQoJCXN0ciA9IHN0ci5yZXBsYWNlKC9eXHMrfFxzKyQvZywgJycpLnJlcGxhY2UoL1xzKy9nLCAnfCcpOw0KCQlyZXR1cm4gJ1xcYig/OicgKyBzdHIgKyAnKSg/IX1+KT9cXGInOw0KCX07DQoJaGlnaGxpZ2h0SmF2YXNjcmlwdC5mb3JtYXQgPSBmdW5jdGlvbihvcHRpb25zKSB7DQoJCXZhciBpLCBjb2RlTGlzdCwgZm9ybWF0dGVkT3B0aW9uczsNCgkJaWYgKG9wdGlvbnMpIHsNCgkJCWlmIChvcHRpb25zID09PSAibm9saW5lcyIpIHsNCgkJCQlmb3JtYXR0ZWRPcHRpb25zID0gew0KCQkJCQkiYWxsIjogWyJub2xpbmVzIl0NCgkJCQl9Ow0KCQkJfQ0KCQl9DQoJCWNvZGVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgicHJlIGNvZGVbY2xhc3NdIik7DQoJCWZvciAoaSA9IDA7IGkgPCBjb2RlTGlzdC5sZW5ndGg7IGkrKykgew0KCQkJLyoqDQoJCQkgKiBVc2VkIHRvIGNvdW50ZXIgYSByZWFsbHkgZnJpZ2dpbiBhbm5veWluZyBpc3N1ZSB3aGVyZSBwYXJlbnROb2RlIHdhcyBudWxsIG9yIHVuZGVmaW5lZC4NCgkJCSAqLw0KCQkJaWYgKGNvZGVMaXN0W2ldLnBhcmVudEVsZW1lbnQpIHsNCgkJCQl2YXIgcGFyZW50TmFtZSA9IGNvZGVMaXN0W2ldLnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOw0KCQkJCS8qKg0KCQkJCSAqIG1ha2Ugc3VyZSB3ZSBhcmVuJ3QgZ3JhYmJpbmcgYW55IGNoaWxkIGNvZGUgdGFncywgdGhvc2Ugc2hvdWxkIGJlIHBhcnNlZCB0byB0ZXh0Lg0KCQkJCSAqLw0KCQkJCWlmIChwYXJlbnROYW1lICE9PSAiY29kZSIgJiYgcGFyZW50TmFtZSAhPT0gInByZSIpIHsNCgkJCQkJaWYgKGhpZ2hsaWdodEphdmFzY3JpcHQubGFuZ3VhZ2VbY29kZUxpc3RbaV0uY2xhc3NOYW1lXSkgew0KCQkJCQkJaGlnaGxpZ2h0SmF2YXNjcmlwdChjb2RlTGlzdFtpXSwgZm9ybWF0dGVkT3B0aW9ucywgaGlnaGxpZ2h0SmF2YXNjcmlwdC5sYW5ndWFnZVtjb2RlTGlzdFtpXS5jbGFzc05hbWVdKTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWNvbnNvbGUuZXJyb3IoIlRoZSBsYW5ndWFnZTogXCIiICsgY29kZUxpc3RbaV0uY2xhc3NOYW1lICsgIlwiLCBpcyBub3QgaW5jbHVkZWQhIik7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoJCX0NCgl9Ow0KCWhpZ2hsaWdodEphdmFzY3JpcHQubGFuZ3VhZ2UgPSB7fTsNCgkoZnVuY3Rpb24oc2gpIHsNCgkJdmFyIG5hdGl2ZVZhciA9IFsiX19kZWZpbmVHZXR0ZXJfXyIsICJfX2RlZmluZVNldHRlcl9fIiwgIl9fbG9va3VwR2V0dGVyX18iLCAiX19sb29rdXBTZXR0ZXJfXyIsICIkMSIsICIkMiIsICIkMyIsICIkNCIsICIkNSIsICIkNiIsICIkNyIsICIkOCIsICIkOSIsICIkXyIsICIkaW5wdXQiLCAiQXJyYXkiLCAiQm9vbGVhbiIsICJDaGFydG9VVEY4IiwgIkRhdGUiLCAiRSIsICJGdW5jdGlvbiIsICJKU09OIiwgIkxOMTAiLCAiTE4yIiwgIkxPRzEwRSIsICJMT0cyRSIsICJNYXRoIiwgIk51bWJlciIsICJPYmplY3QiLCAiUEkiLCAiUmVnRXhwIiwgIlNRUlQxXzIiLCAiU1FSVDIiLCAiU3RyaW5nIiwgIlVUQyIsICJhYnMiLCAiYWNvcyIsICJhbmNob3IiLCAiYXBwbHkiLCAiYXNpbiIsICJhdGFuIiwgImF0YW4yIiwgImJpZyIsICJiaW5kIiwgImJsaW5rIiwgImJvbGQiLCAiY2FsbCIsICJjZWlsIiwgImNoYXJBdCIsICJjaGFyQ29kZUF0IiwgImNvbmNhdCIsICJjb3MiLCAiY3JlYXRlIiwgImRlZmluZVByb3BlcnRpZXMiLCAiZGVmaW5lUHJvcGVydHkiLCAiZG9jdW1lbnQiLCAiZXZlcnkiLCAiZXhwIiwgImZpbHRlciIsICJmaXhlZCIsICJmbG9vciIsICJmb250Y29sb3IiLCAiZm9udHNpemUiLCAiZm9yRWFjaCIsICJmcmVlemUiLCAiZ2V0RGF0ZSIsICJnZXREYXkiLCAiZ2V0RnVsbFllYXIiLCAiZ2V0SG91cnMiLCAiZ2V0TWlsbGlzZWNvbmRzIiwgImdldE1pbnV0ZXMiLCAiZ2V0TW9udGgiLCAiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwgImdldE93blByb3BlcnR5TmFtZXMiLCAiZ2V0UHJvdG90eXBlT2YiLCAiZ2V0U2Vjb25kcyIsICJnZXRUaW1lIiwgImdldFRpbWV6b25lT2Zmc2V0IiwgImdldFVUQ0RhdGUiLCAiZ2V0VVRDRGF5IiwgImdldFVUQ0Z1bGxZZWFyIiwgImdldFVUQ0hvdXJzIiwgImdldFVUQ01pbGxpc2Vjb25kcyIsICJnZXRVVENNaW51dGVzIiwgImdldFVUQ01vbnRoIiwgImdldFVUQ1NlY29uZHMiLCAiZ2V0WWVhciIsICJoYXNPd25Qcm9wZXJ0eSIsICJpbmRleE9mIiwgImlzRXh0ZW5zaWJsZSIsICJpc0Zyb3plbiIsICJpc1Byb3RvdHlwZU9mIiwgImlzU2VhbGVkIiwgIml0YWxpY3MiLCAiam9pbiIsICJsYXN0SW5kZXhPZiIsICJsaW5rIiwgImxvY2FsZUNvbXBhcmUiLCAibG9nIiwgIm1hcCIsICJtYXRjaCIsICJtYXgiLCAibWluIiwgIm5vdyIsICJwYXJzZSIsICJwb3AiLCAicG93IiwgInByZXZlbnRFeHRlbnNpb25zIiwgInByb3BlcnR5SXNFbnVtZXJhYmxlIiwgInB1c2giLCAicmFuZG9tIiwgInJlZHVjZSIsICJyZWR1Y2VSaWdodCIsICJyZXBsYWNlIiwgInJldmVyc2UiLCAicm91bmQiLCAic2VhbCIsICJzZWFyY2giLCAic2V0RGF0ZSIsICJzZXRGdWxsWWVhciIsICJzZXRIb3VycyIsICJzZXRNaWxsaXNlY29uZHMiLCAic2V0TWludXRlcyIsICJzZXRNb250aCIsICJzZXRTZWNvbmRzIiwgInNldFRpbWUiLCAic2V0VVRDRGF0ZSIsICJzZXRVVENGdWxsWWVhciIsICJzZXRVVENIb3VycyIsICJzZXRVVENNaWxsaXNlY29uZHMiLCAic2V0VVRDTWludXRlcyIsICJzZXRVVENNb250aCIsICJzZXRVVENTZWNvbmRzIiwgInNldFllYXIiLCAic2hpZnQiLCAic2luIiwgInNsaWNlIiwgInNtYWxsIiwgInNvbWUiLCAic29ydCIsICJzcGxpY2UiLCAic3BsaXQiLCAic3FydCIsICJzdHJpa2UiLCAic3RyaW5naWZ5IiwgInN1YiIsICJzdWJzdHIiLCAic3Vic3RyaW5nIiwgInN1cCIsICJ0YW4iLCAidG9EYXRlU3RyaW5nIiwgInRvRXhwb25lbnRpYWwiLCAidG9GaXhlZCIsICJ0b0dNVERhdGVTdHJpbmciLCAidG9JU09EYXRlU3RyaW5nIiwgInRvSlNPTiIsICJ0b0xvY2FsZURhdGVTdHJpbmciLCAidG9Mb2NhbGVMb3dlckNhc2UiLCAidG9Mb2NhbGVTdHJpbmciLCAidG9Mb2NhbGVUaW1lU3RyaW5nIiwgInRvTG9jYWxlVXBwZXJDYXNlIiwgInRvTG93ZXJDYXNlIiwgInRvUHJlY2lzaW9uIiwgInRvU3RyaW5nIiwgInRvVGltZVN0cmluZyIsICJ0b1VUQ1N0cmluZyIsICJ0b1VwcGVyQ2FzZSIsICJ0cmltIiwgInRyaW1MZWZ0IiwgInRyaW1SaWdodCIsICJ1bnNoaWZ0IiwgInZhbHVlT2YiLCAid2luZG93Il07DQoJCXZhciByZXNlcnZlZCA9IFsiZnVuY3Rpb24iLCAidmFyIiwgImxldCIsICJjb25zdCIsICJ2b2lkIiwgIm5hdGl2ZSJdOw0KCQl2YXIgY29uc3RydWN0cyA9IFsiaWYiLCAiZm9yIiwgIndoaWxlIiwgIndpdGgiLCAiZWxzZSIsICJyZXR1cm4iLCAiYnJlYWsiLCAibmV3IiwgImluIiwgInN3aXRjaCIsICJ0cnkiLCAiY2F0Y2giLCAiY2FzZSJdOw0KCQl2YXIgbGFuZyA9IFsiTmFOIiwgInRydWUiLCAiZmFsc2UiLCAidW5kZWZpbmVkIiwgIm51bGwiXTsNCgkJdmFyIGNvbnN0YW50ID0gWyJhcmd1bWVudHMiLCAiY2FsbGVyIiwgImNvbnN0cnVjdG9yIiwgImtleXMiLCAicHJvdG90eXBlIiwgIk1BWF9WQUxVRSIsICJNSU5fVkFMVUUiLCAiTkVHQVRJVkVfSU5GSU5JVFkiLCAiUE9TSVRJVkVfSU5GSU5JVFkiLCAibXVsdGlsaW5lIiwgImxhc3RNYXRjaCIsICJsYXN0UGFyZW4iLCAibGVmdENvbnRleHQiLCAibGVuZ3RoIiwgIm5hbWUiLCAicmlnaHRDb250ZXh0IiwgImlucHV0Il07DQoJCXZhciByZWdleCA9IHsNCgkJCSJzaW5nbGVDb21tZW50IjogL1wvXC8uKz8oPz1cbnxccnwkKS9pZywNCgkJCSJtdWx0aUNvbW1lbnQiOiAvXC9cKltcc1xTXSs/XCpcLy9nLA0KCQkJInN0cmluZyI6IC8oPzonW14nXFxdKig/OlxcLlteJ1xcXSopKicpfCg/OiJbXiJcXF0qKD86XFwuW14iXFxdKikqIikvZywNCgkJCSJudW1iZXIiOiAvXGJbKy1dPyg/Oig/OjB4W0EtRmEtZjAtOV0rKXwoPzooPzpbXGRdKlwuKT9bXGRdKyg/OltlRV1bKy1dP1tcZF0rKT8pKXU/KD86KD86aW50KD86OHwxNnwzMnw2NCkpfEwpP1xiKD8hXH1cfikvZywNCgkJCSJtYXRoIjogLyhcfHxcK3xcPXxcLXxcL3xcPnxcPHxcIXxcP3xcJnxcJXxcJCkoPyFbMC05XSp9fikvZywNCgkJCSJicmFja2V0IjogL1x7fFx9fFwofFwpfFxbfFxdL2csDQoJCQkidGFnIjogL1w8KD86XCF8XC8pP1thLXpdW2EtejAtMVwtXVxzKig/OltePl0rKT9cPi9pZywNCgkJCSJmdW5jdGlvbiI6IC9cYig/IWZ1bmN0aW9ufGlmfGVsc2V8Zm9yfHdoaWxlfHdpdGh8dHJ5KSg/OltBLVphLXpdfF8pW0EtWmEtejAtOV9dKig/PVsgXHRdKlwoKS9nLA0KCQkJImVzY2FwZWQiOiAvXFwoPzowWzAtM11bMC03XVswLTddfFswLTNdWzAtN11bMC03XXxbMC03XVswLTddfFswLTldfC4pL2cNCgkJfTsNCgkJdmFyIHJlZ2V4TGlzdCA9IFt7DQoJCQlyZWdleDogbmV3IFJlZ0V4cChzaC5nZXRLZXl3b3JkcyhuYXRpdmVWYXIpLCAnZ20nKSwNCgkJCWNzczogIm5hdGl2ZSINCgkJfSwgew0KCQkJcmVnZXg6IG5ldyBSZWdFeHAoc2guZ2V0S2V5d29yZHMocmVzZXJ2ZWQpLCAnZ20nKSwNCgkJCWNzczogInJlc2VydmVkIg0KCQl9LCB7DQoJCQlyZWdleDogbmV3IFJlZ0V4cChzaC5nZXRLZXl3b3Jkcyhjb25zdHJ1Y3RzKSwgJ2dtJyksDQoJCQljc3M6ICJjb25zdHJ1Y3RzIg0KCQl9LCB7DQoJCQlyZWdleDogbmV3IFJlZ0V4cChzaC5nZXRLZXl3b3JkcyhsYW5nKSwgJ2dtJyksDQoJCQljc3M6ICJsYW5ndWFnZSINCgkJfSwgew0KCQkJcmVnZXg6IG5ldyBSZWdFeHAoc2guZ2V0S2V5d29yZHMoY29uc3RhbnQpLCAnZ20nKSwNCgkJCWNzczogImNvbnN0YW50Ig0KCQl9LCB7DQoJCQlyZWdleDogcmVnZXgudGFnLA0KCQkJY3NzOiAiY29uc3RydWN0cyINCgkJfSwgew0KCQkJcmVnZXg6IHJlZ2V4Lm51bWJlciwNCgkJCWNzczogIm51bWJlciINCgkJfSwgew0KCQkJcmVnZXg6IHJlZ2V4Lm1hdGgsDQoJCQljc3M6ICJjb25zdHJ1Y3RzIg0KCQl9LCB7DQoJCQlyZWdleDogcmVnZXhbImZ1bmN0aW9uIl0sDQoJCQljc3M6ICJmdW5jdGlvbiINCgkJfV07DQoJCXNoLmxhbmd1YWdlID0gc2gubGFuZ3VhZ2UgfHwge307DQoJCXNoLmxhbmd1YWdlWyJqcyJdID0gew0KCQkJcmVnZXg6IHJlZ2V4LA0KCQkJcmVnZXhMaXN0OiByZWdleExpc3QNCgkJfTsNCgl9KGhpZ2hsaWdodEphdmFzY3JpcHQpKTsNCgl3aW5kb3cuaGlnaGxpZ2h0SmF2YXNjcmlwdCA9IGhpZ2hsaWdodEphdmFzY3JpcHQ7DQp9KHdpbmRvdykpOw==";